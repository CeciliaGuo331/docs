---
title: 连续时间下的异质性代理人模型
date: 2025-09-02
details: 量化宏观初探-HACT论文精读
---

# 连续时间下的异质性代理人模型

## HJB 和 KFE 方程

* **HJB Equation**: **哈密尔顿-雅可比-贝尔曼方程** (Hamilton-Jacobi-Bellman Equation)
* **KFE Equation**: **柯尔莫哥洛夫前向方程** (Kolmogorov Forward Equation)。在很多经济学和物理学文献中，它更常被称为 **福克-普朗克方程** (Fokker-Planck Equation)。两者本质上描述的是同一个过程。

想象一下，我们正在分析一个复杂的经济系统，比如整个国家的宏观经济。这个系统里有两类核心问题：

1.  **微观层面**：身处其中的每一个“个体”（比如一个家庭或一家公司）如何做出最优决策？例如，一个家庭如何决定每个月消费多少、储蓄多少，才能让自己的一生过得最“幸福”？
2.  **宏观层面**：成千上万个家庭和公司的决策汇集在一起，会形成怎样的整体经济景象？比如，整个社会的财富分布是怎样的？是贫富差距悬殊，还是橄榄形社会？这个分布又是如何随时间演变的？

HJB和KFE方程，恰好就是分别回答这两类问题的数学语言。

#### 1. HJB方程：个体最优决策的“导航系统”

HJB方程处理的是**最优控制 (Optimal Control)** 问题。它的目标是为单个决策者（我们称之为“代理人”，Agent）找到一个在动态不确定环境中最大化其长期目标的策略。

* **核心概念：价值函数 (Value Function)**
    * 我们定义一个核心变量 $V(x, t)$，称为**价值函数**。它的含义是：在时间 $t$，当你的状态为 $x$ 时（比如，$x$ 代表你当前拥有的财富），如果你从现在开始一直采取最优策略，你未来能够获得的总期望效用（或利润、回报等）是多少。
    * 所以，$V(x, t)$ 是你当前状态的“价值”或“潜力”的衡量。

* **核心思想：贝尔曼最优性原则 (Bellman's Principle of Optimality)**
    * HJB方程是理查德·贝尔曼的动态规划思想在连续时间下的延伸。其核心思想可以通俗地理解为：“**无论过去如何，从当前状态开始的后续最优策略，只取决于当前状态，而与如何达到该状态无关。**”
    * HJB方程精确地描述了价值函数 $V(x, t)$ 必须满足的数学关系。它将价值的微小时间变化与三个因素联系起来：
        1.  **当前回报 (Instantaneous Return)**：你现在做出的决策（比如消费）能立刻带给你的满足感。
        2.  **状态变化 (Change in State)**：你的决策（比如储蓄）会如何改变你的状态（财富的增减）。
        3.  **不确定性 (Uncertainty)**：未来随机事件（比如失业风险、投资收益波动）对你价值的潜在影响。

* **方程形式（非严格）**：
    $$
    \frac{\partial V}{\partial t} + \max_{c(t)} \left\{ u(c(t)) + \frac{\partial V}{\partial x} \cdot f(x(t), c(t)) + \frac{1}{2} \frac{\partial^2 V}{\partial x^2} \cdot \sigma^2(x(t), c(t)) \right\} = \rho V
    $$
    这是一个偏微分方程 (Partial Differential Equation, PDE)。虽然看起来复杂，但它的经济学直觉很清晰：左边描述了总价值的来源（当前效用 + 价值的确定性变化 + 价值的随机性变化），右边的 $\rho V$ 代表了时间贴现（未来的价值不如现在的价值重要）。方程中的 $\max$ 部分体现了“最优”决策，即选择控制变量 $c(t)$（例如消费）来最大化花括号内的所有项。

* **类比**：
    HJB方程就像一个超级智能的GPS导航系统。你输入你的目的地（最大化一生效用），它不仅会告诉你从当前位置出发的最佳路线，更厉害的是，它能在地图上的**任何一个点**都告诉你，从那个点出发的最佳路线是什么。求解HJB方程，就是绘制出这张完整的“最优决策地图”。

#### 2. KFE方程：描绘群体演化的“动态地图”

与HJB关注单个“点”的最优路径不同，KFE关注的是由无数个这样的“点”组成的**群体**的宏观动态。

* **核心概念：概率密度函数 (Probability Density Function, PDF)**
    * 我们定义一个函数 $g(x, t)$，代表在时间 $t$，拥有状态 $x$ 的代理人（比如财富为 $x$ 的家庭）在总人口中所占的**密度**或**比例**。
    * 对 $g(x, t)$ 在所有可能的 $x$ 上进行积分，总和为1（即100%的人口）。

* **核心思想：粒子守恒 (Conservation of "Particles")**
    * KFE描述了 $g(x, t)$ 是如何随时间演变的。它的逻辑基础是“守恒定律”。想象一下，在某个财富水平 $x$ 附近的一小撮人，他们的数量在下一瞬间会发生怎样的变化？
        * **流入 (Inflow)**：一些财富略低于 $x$ 的人，因为储蓄或好的投资运气，财富增加，进入了这个区间。
        * **流出 (Outflow)**：这个区间里的一些人，因为消费或坏的运气，财富减少，离开了这个区间。
    * KFE精确地刻画了这种由于代理人的个体行为（储蓄决策）和遇到的随机冲击（投资风险）导致的“人口”在状态空间（财富轴）上的流动。

* **方程形式（非严格）**：
    $$
    \frac{\partial g(x, t)}{\partial t} = - \frac{\partial}{\partial x} [\mu(x, t) g(x, t)] + \frac{1}{2} \frac{\partial^2}{\partial x^2} [\sigma^2(x, t) g(x, t)]
    $$
    这个方程描述了密度 $g(x, t)$ 的时间变化率（左边）等于由“漂移”（$\mu$，个体财富的平均变化趋势）和“扩散”（$\sigma^2$，随机冲击导致的财富波动）引起的密度流动的总和（右边）。

* **类比**：
    想象一下你从高空俯瞰一条拥挤的公路。你并不关心每一辆车的具体驾驶操作（那是HJB的工作），你关心的是**车流的密度**在公路上是如何分布和变化的。比如，某个路段因为有事故，车流密度会变大；某个路段是下坡，车速快，车流密度会变稀疏。KFE就是描述这条公路上车流密度 $g(x, t)$（$x$是公路上的位置）随时间 $t$ 变化的方程。

#### HJB与KFE的深刻联系：从微观基础到宏观现象

在现代宏观经济学，尤其是**异质性代理人模型 (Heterogeneous Agent Models)** 中，HJB和KFE是天生一对，它们共同构建了分析框架：

1.  **HJB 提供个体行为规则**：首先，我们假设经济中的每一个家庭都会根据自身的财富 $x$ 和宏观经济变量（如平均工资、利率等）来求解自己的HJB方程，从而得到一个最优的决策规则（Policy Function），例如 $c(x)$，即财富为 $x$ 时应该消费多少。

2.  **KFE 汇总个体行为，形成宏观分布**：然后，我们将这个从HJB中得到的决策规则 $c(x)$ 代入到KFE方程中。KFE会告诉我们，当成千上万的家庭都遵循这个规则时，整个社会的财富分布 $g(x, t)$ 会如何演变。

3.  **宏观与微观的闭环**：最关键的一步是，由KFE计算出的宏观分布 $g(x, t)$ 本身会决定宏观经济变量。例如，将所有人的储蓄加总，就可以得到整个经济的总资本供给，从而决定市场的均衡利率。而这个新计算出的利率，又会反过来影响每个家庭在HJB方程中做决策的外部环境。

如此一来，HJB和KFE就形成了一个宏观与微观互动的完美闭环。这也是为什么计算经济学如此重要的原因——这种复杂的相互作用通常无法用简单的数学公式求解，必须借助强大的计算机进行数值模拟。

#### 总结

| 特性             | HJB 方程 (Hamilton-Jacobi-Bellman)           | KFE 方程 (Kolmogorov Forward)                |
| ---------------- | -------------------------------------------- | -------------------------------------------- |
| **视角 (Perspective)** | **微观 (Micro)**：单个代理人的最优决策       | **宏观 (Macro)**：大量代理人的群体分布       |
| **求解目标 (Objective)** | **价值函数** $V(x, t)$ 和**最优策略** $c(x)$ | **概率密度函数** $g(x, t)$                   |
| **数学本质 (Nature)** | 最优控制理论 (Optimal Control)             | 随机过程理论 (Stochastic Process)          |
| **经济学应用 (Application)** | 消费-储蓄、投资组合、企业投资决策        | 财富/收入分配、宏观经济动态、失业率演变      |
| **在模型中的角色** | **“大脑”**：决定个体如何行动               | **“统计局”**：汇总个体行为，描绘宏观景象     |
